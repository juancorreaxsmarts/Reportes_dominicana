SELECT 	am.id,		
	am.id as invoice_id,		
	am.ref as ncf,		
	rp.vat as rnc,		
	rp.name as cliente,		
	am.invoice_date as invoice_date,		
	to_char(am.invoice_date, 'DD/MM/YYYY') as fecha_comprobante,		
	to_char(am.invoice_date, 'YYYYMMDD') as fecha_dgii,		
	case 		
		when am.cancellation_type = '01' then '01 - Deterioro de Factura Pre-impresa'	
		when am.cancellation_type = '02' then '02 - Errores de Impresion (Factura Pre-impresa)'	
		when am.cancellation_type = '03' then '03 - Impresion Defectuosa'	
		when am.cancellation_type = '04' then '04 - Correccion de la Informacion'	
		when am.cancellation_type = '05' then '05 - Cambio de Productos'	
		when am.cancellation_type = '06' then '06 - Devolucion de Productos'	
		when am.cancellation_type = '07' then '07 - Omision de Productos'	
		when am.cancellation_type = '08' then '08 - Errores en Secuencia de NCF'	
		when am.cancellation_type = '09' then '09 - Por Cese de Operaciones'	
		when am.cancellation_type = '10' then '10 - Perdida o Hurto de Talonarios'	
	else '' end as tipo_cancelacion		 FROM account_move am	
inner join res_partner rp on		
rp.id = am.partner_id	 WHERE am.type in ('out_invoice',	
'out_refund')	
and am.state = 'cancel'	